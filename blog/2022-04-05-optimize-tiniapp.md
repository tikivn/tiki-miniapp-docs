---
title: Tá»‘i Æ°u hoÃ¡ Tini App
---

Tá»‘i Æ°u hoÃ¡ luÃ´n lÃ  má»™t trong nhá»¯ng váº¥n Ä‘á» quan trá»ng nháº¥t khi xÃ¢y dá»±ng báº¥t ká»³ á»©ng dá»¥ng nÃ o. Náº¿u á»©ng dá»¥ng táº£i cÃ ng nhanh, sá»­ dá»¥ng cÃ ng mÆ°á»£t, thÃ¬ sáº½ Ä‘em Ä‘Æ°á»£c tráº£i nghiá»‡m tá»‘t cho ngÆ°á»i sá»­ dá»¥ng, giÃºp á»©ng dá»¥ng cá»§a báº¡n sáº½ thu hÃºt vÃ  giá»¯ chÃ¢n Ä‘Æ°á»£c nhiá»u ngÆ°á»i dÃ¹ng hÆ¡n.

QuÃ¡ trÃ¬nh tá»‘i Æ°u hoÃ¡ cÃ³ thá»ƒ tá»‘n khÃ¡ nhiá»u thá»i gian vÃ  cÃ´ng sá»©c, bao gá»“m cáº£ viá»‡c lÃ m tháº¿ nÃ o á»©ng dá»¥ng Ä‘Æ°á»£c táº£i nhanh nháº¥t, UI/UX mang láº¡i tráº£i nghiá»‡m tá»‘t nháº¥t cÅ©ng nhÆ° Ä‘áº£m báº£o á»©ng dá»¥ng khÃ´ng bá»‹ cháº­m trong quÃ¡ trÃ¬nh sá»­ dá»¥ng,...Trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng Tini App, Ä‘á»™i ngÅ© phÃ¡t triá»ƒn Ä‘Ã£ cá»‘ gáº¯ng tá»‘i Æ°u cÃ¡c thÃ nh pháº§n bÃªn dÆ°á»›i nhÆ° framework, jsAPI, components,... Ä‘á»ƒ Ä‘áº£m báº£o cÃ¡c á»©ng dá»¥ng Tini App Ä‘Æ°á»£c táº£i vÃ  váº­n hÃ nh tá»‘t nháº¥t cÃ³ thá»ƒ. Tuy nhiÃªn, viá»‡c tá»‘i Æ°u á»©ng dá»¥ng cÃ²n cáº§n sá»± gÃ³p sá»©c tá»« báº£n thÃ¢n cÃ¡c nhÃ  phÃ¡t triá»ƒn app. Trong pháº¡m vi bÃ i viáº¿t nÃ y, mÃ¬nh sáº½ chia sáº» vá»›i cÃ¡c báº¡n má»™t sá»‘ kinh nghiá»‡m Ä‘á»ƒ tÄƒng tá»‘c Ä‘á»™ cá»§a Tini App. ğŸš€

### Giáº£m thiá»ƒu kÃ­ch thÆ°á»›c cá»§a App

Khi má»™t á»©ng dá»¥ng Tini App Ä‘Æ°á»£c phÃ¡t hÃ nh trÃªn [Kho á»©ng dá»¥ng](https://tiki.vn/apps/com.tini.appstore) cá»§a Tiki. Máº·c Ä‘á»‹nh sáº½ khÃ´ng Ä‘Æ°á»£c Ä‘Ã­nh kÃ¨m vÃ o trong app cá»§a Tiki, mÃ  chá»‰ Ä‘Æ°á»£c táº£i vá» khi ngÆ°á»i dÃ¹ng truy cáº­p vÃ o á»©ng dá»¥ng Ä‘Ã³, viá»‡c nÃ y sáº½ Ä‘áº£m báº£o Ä‘Æ°á»£c kÃ­ch thÆ°á»›c cá»§a app Tiki sáº½ nháº¹ hÆ¡n vÃ¬ á»©ng dá»¥ng chá»‰ Ä‘Æ°á»£c táº£i khi thá»±c sá»± cáº§n thiáº¿t. Do Ä‘Ã³, viá»‡c app cá»§a báº¡n cÃ³ kÃ­ch thÆ°á»›c cÃ ng nháº¹, thÃ¬ sáº½ táº£i cÃ ng nhanh.

Má»™t Tini App cÃ³ giá»›i háº¡n dung lÆ°á»£ng lÃ  5Mb, báº¡n cÃ³ thá»ƒ yÃªu cáº§u tÄƒng kÃ­ch thÆ°á»›c lÃªn náº¿u cáº§n thiáº¿t, tuy nhiÃªn sáº½ thÃ´ng qua quÃ¡ trÃ¬nh kiá»ƒm Ä‘á»‹nh cá»§a team Ä‘á»ƒ Ä‘Æ°á»£c duyá»‡t. NhÆ°ng nhÆ° mÃ¬nh nÃ³i tá»« trÆ°á»›c, Tini App cÃ³ kÃ­ch thÆ°á»›c cÃ ng nháº¹, thÃ¬ sáº½ Ä‘Æ°á»£c load cÃ ng nhanh.

CÃ¡c thÃ nh pháº§n Ä‘Æ°á»£c táº£i vá» trong má»™t Tini App mÃ¬nh sáº½ chia thÃ nh 2 thÃ nh pháº§n cÆ¡ báº£n: Code Ä‘á»ƒ cháº¡y vÃ  TÃ i nguyÃªn cá»§a á»©ng dá»¥ng.

- Code Ä‘á»ƒ cháº¡y bao gá»“m: code trong file js, txml, tcss, sjs vÃ  cÃ¡c thÆ° viá»‡n trong node_modules (náº¿u cÃ³)

  Äá»ƒ tá»‘i Æ°u hoÃ¡ dung lÆ°á»£ng code Ä‘á»ƒ cháº¡y, báº¡n chá»‰ cáº§n tuÃ¢n theo nguyÃªn táº¯c: chá»‰ dÃ¹ng náº¿u thá»±c sá»± cáº§n thiáº¿t, khÃ´ng dÃ¹ng thÃ¬ xoÃ¡ nhá»¯ng pháº§n thá»«a Ä‘i.
  VÃ­ dá»¥: sáº½ khÃ´ng cáº§n pháº£i cÃ i package [momentjs](https://momentjs.com/) chá»‰ Ä‘á»ƒ format ngÃ y thÃ¡ng, hay chá»‰ sá»­ dá»¥ng cÃ¡c hÃ m nhÆ° isEmpty mÃ  pháº£i cÃ i cáº£ package [lodash](https://lodash.com/) vÃ o. ÄÃ¢y lÃ  nhá»¯ng hÃ m mÃ  báº¡n hoÃ n toÃ n cÃ³ thá»ƒ tá»± viáº¿t hoáº·c tham kháº£o trÃªn máº¡ng, viá»‡c loáº¡i bá» cÃ¡c thÆ° viá»‡n/code khÃ´ng cáº§n thiáº¿t khÃ´ng chá»‰ giÃºp code báº¡n nháº¹ hÆ¡n mÃ  cÃ²n giÃºp báº¡n hiá»ƒu rÃµ hÆ¡n vá» code vÃ  cÃ¡ch lÃ m cá»§a hÃ m Ä‘Ã³. Táº¥t nhiÃªn bÃ¹ láº¡i nÃ³ sáº½ tá»‘n thá»i gian hÆ¡n Ä‘á»ƒ báº¡n pháº£i tá»± lÃ m Ä‘iá»u Ä‘Ã³, nhÆ°ng Ä‘á»‘i vá»›i mÃ¬nh, Ä‘Ã³ lÃ  sá»± Ä‘Ã¡nh Ä‘á»•i Ä‘Ã¡ng giÃ¡. HÃ£y nhá»›: cÃ ng nháº¹ cÃ ng tá»‘t ğŸ˜„

  PhÃ­a framework Tini App cÅ©ng sáº½ Ä‘áº£m báº£o quÃ¡ trÃ¬nh minify source code Ä‘á»ƒ lÃ m giáº£m dung lÆ°á»£ng code cá»§a cÃ¡c báº¡n láº¡i, vÃ  trong tÆ°Æ¡ng lai, cÃ³ thá»ƒ bá»n mÃ¬nh sáº½ há»— trá»£ thÃªm cÃ¡c cÃ¡ch Ä‘á»ƒ lazy load cÃ¡c page Ä‘á»ƒ lÃ m giáº£m dung lÆ°á»£ng file Ä‘áº§u tiÃªn Ä‘Æ°á»£c load tá»›i má»©c nhanh nháº¥t cÃ³ thá»ƒ.

- CÃ¡c tÃ i nguyÃªn bao gá»“m: hÃ¬nh áº£nh, video, audio, json, font,...

  Trong cÃ¡c tÃ i nguyÃªn trÃªn, cÃ³ váº» hÃ¬nh áº£nh lÃ  tÃ i nguyÃªn thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng nhiá»u nháº¥t. Náº¿u báº¡n nÃ o Ä‘Ã£ lÃ m qua vá»›i component [image](/docs/component/basic/media/image) thÃ¬ sáº½ biáº¿t cÃ³ 3 cÃ¡ch Ä‘á»ƒ khai bÃ¡o src cho hÃ¬nh: dÃ¹ng Ä‘Æ°á»ng dáº«n trong app, dÃ¹ng base 64 vÃ  dÃ¹ng link CDN. Trong Ä‘Ã³ mÃ¬nh khuyáº¿n khÃ­ch khÃ´ng nÃªn dÃ¹ng áº£nh base 64 cho cÃ¡c hÃ¬nh cÃ³ dung lÆ°á»£ng lá»›n, ngoÃ i ra, náº¿u trong app báº¡n sá»­ dá»¥ng má»™t hÃ¬nh mÃ  háº§u nhÆ° cÃ³ ráº¥t Ã­t sá»± thay Ä‘á»•i dÃ¹ cÃ³ nÃ¢ng lÃªn version vÃ  app cá»§a báº¡n thÆ°á»ng xuyÃªn cÃ³ sá»± thay Ä‘á»•i version, thÃ¬ báº¡n nÃªn dÃ¹ng má»™t CDN riÃªng Ä‘á»ƒ lÆ°u hÃ¬nh áº£nh Ä‘Ã³. Bá»Ÿi vÃ¬ cÃ¡c tÃ i nguyÃªn trong Tini App sáº½ Ä‘Æ°á»£c lÆ°u trá»¯ trong CDN cá»§a Tiki, vÃ  má»—i láº§n app cá»§a báº¡n thay Ä‘á»•i version thÃ¬ Ä‘Æ°á»ng dáº«n cá»§a file hÃ¬nh Ä‘Ã³ sáº½ bá»‹ thay Ä‘á»•i theo version má»›i, Ä‘iá»u Ä‘Ã³ dáº«n Ä‘áº¿n khÃ´ng tá»‘i Æ°u vá» phÃ­a cache cá»§a app. VÃ¬ váº­y, náº¿u bÃªn báº¡n khÃ´ng cÃ³ CDN, hoáº·c vá»›i nhá»¯ng hÃ¬nh áº£nh nhá» gá»n thÃ¬ cÃ³ thá»ƒ bá» vÃ o app, cÃ²n khÃ´ng thÃ¬ báº¡n nÃªn táº£i áº£nh Ä‘Ã³ lÃªn CDN vÃ  dÃ¹ng má»™t link cá»‘ Ä‘á»‹nh.

  Äá»‘i vá»›i font, máº·c Ä‘á»‹nh Tini App sáº½ sá»­ dá»¥ng font [Inter](/docs/design/styles/font) cho toÃ n bá»™ app. Viá»‡c thay Ä‘á»•i má»™t font khÃ¡c sáº½ áº£nh hÆ°á»Ÿng tá»›i tráº£ nghiá»‡m táº£i app cÅ©ng nhÆ° tÄƒng dung lÆ°á»£ng cá»§a app lÃªn náº¿u cÃ¡c file font Ä‘Æ°á»£c Ä‘Ã­nh kÃ¨m trong app. Náº¿u báº¡n cÃ³ nhu cáº§u dÃ¹ng font khÃ¡c, báº¡n cÃ³ thá»ƒ xem jsAPI [loadFontFace](/docs/api/ui/font/load-font-face)

  Vá»›i cÃ¡c tÃ i nguyÃªn khÃ¡c nhÆ° video, audio, json,... báº¡n cÅ©ng nÃªn cÃ¢n nháº¯c vá» dung lÆ°á»£ng cá»§a chÃºng Ä‘á»ƒ cÃ³ thá»ƒ dÃ¹ng CDN hay bá» vÃ o app má»™t cÃ¡ch há»£p lÃ½

### Tá»‘i Æ°u hÃ¬nh áº£nh

MÃ¬nh sáº½ dÃ nh cáº£ má»™t pháº§n Ä‘á»ƒ nÃ³i vá» tá»‘i Æ°u hÃ¬nh áº£nh trong app, bá»Ÿi vÃ¬ háº§u nhÆ° hÃ¬nh áº£nh xuáº¥t hiá»‡n ráº¥t nhiá»u chá»— vÃ  háº§u nhÆ° page nÃ o cÅ©ng sáº½ cÃ³ hÃ¬nh. Viá»‡c tá»‘i Æ°u Ä‘Æ°á»£c hÃ¬nh áº£nh sáº½ mang Ä‘áº¿n nhá»¯ng tráº£i nghiá»‡m Ä‘Ã¡ng giÃ¡ cho app cá»§a báº¡n.

#### Giáº£m dung lÆ°á»£ng hÃ¬nh áº£nh

VÃ¢ng, láº¡i lÃ  giáº£m dung lÆ°á»£ng. MÃ¬nh láº¡i pháº£i nháº¯c Ä‘i nháº¯c láº¡i tá»« nÃ y vÃ¬ nÃ³ tháº­t sá»± ráº¥t cáº§n thiáº¿t. HÃ¬nh áº£nh vÃ  cÃ¡c tÃ i nguyÃªn cÃ ng nháº¹ thÃ¬ nÃ³ hiá»ƒn thá»‹ cÃ ng nhanh, ngoÃ i ra nÃ³ sáº½ giÃºp tiáº¿t kiá»‡m ...4G cá»§a ngÆ°á»i dÃ¹ng :)

CÃ³ nhiá»u cÃ¡ch Ä‘á»ƒ giáº£m dung lÆ°á»£ng cá»§a hÃ¬nh, báº¡n cÃ³ thá»ƒ giáº£m tá»« lÃºc xuáº¥t hÃ¬nh ra tá»« cÃ¡c cÃ´ng cá»¥ nhÆ° Photoshop, Illustrator hoáº·c sá»­ dá»¥ng cÃ¡c cÃ´ng cá»¥ miá»…n phÃ­ trÃªn máº¡ng nhÆ° https://tinypng.com/ Ä‘á»‘i vá»›i cÃ¡c hÃ¬nh cÃ³ Ä‘á»‹nh dáº¡ng jpeg, png hoáº·c webp. Pháº£i nÃ³i lÃ  mÃ¬nh cá»±c ká»³ thÃ­ch trang nÃ y, bá»Ÿi nÃ³ cá»±c ká»³ há»¯u Ã­ch, báº¡n chá»‰ viá»‡c quÄƒng hÃ¬nh cá»§a mÃ¬nh lÃªn vÃ  bÃ¹m... dung lÆ°á»£ng hÃ¬nh cá»§a báº¡n sáº½ giáº£m Ä‘i má»™t cÃ¡ch Ä‘Ã¡ng ká»ƒ ğŸ”¥ Náº¿u hÃ¬nh áº£nh báº¡n khÃ´ng Ä‘Ã²i há»i sá»± trong suá»‘t (transparent), báº¡n nÃªn dÃ¹ng áº£nh dáº¡ng jpeg thay vÃ¬ png, vá»›i Ä‘á»‹nh dáº¡ng webp, hiá»‡n táº¡i phÃ­a Tini App chÆ°a há»— trá»£ tuy nhiÃªn bá»n mÃ¬nh sáº½ cá»‘ gáº¯ng há»— trá»£ trong thá»i gian tá»›i. Äá»‘i vá»›i hÃ¬nh svg, báº¡n cÅ©ng cÃ³ thá»ƒ dÃ¹ng trang nÃ y Ä‘á»ƒ giáº£m dung lÆ°á»£ng: https://jakearchibald.github.io/svgomg/

#### Sá»­ dá»¥ng CDN xá»‹n xÃ²

NhÆ° mÃ¬nh nÃ³i á»Ÿ trÃªn, cÃ¡c tÃ i nguyÃªn trong Tini App sáº½ Ä‘Æ°á»£c lÆ°u trá»¯ trÃªn CDN cá»§a Tiki, vÃ  phÃ­a Tiki CDN sáº½ Ä‘áº£m báº£o tÃ i nguyÃªn cá»§a báº¡n Ä‘Æ°á»£c cache vÃ  Ä‘Æ°á»£c nÃ©n vá»›i [gzip](https://developers.google.com/speed/docs/insights/EnableCompression). Tuy nhiÃªn Ä‘á»‘i vá»›i cÃ¡c tÃ i nguyÃªn riÃªng cá»§a báº¡n, hÃ£y nÃªn dÃ¹ng má»™t CDN há»— trá»£ cáº£ cache vÃ  nÃ©n nhÆ° gzip nhÃ©

#### Sá»­ dá»¥ng lazyload

HÃ£y lazyload hÃ¬nh náº¿u cÃ³ thá»ƒ, nÃ³ khÃ´ng chá»‰ giÃºp app báº¡n Ä‘Æ°á»£c load nhanh hÆ¡n, tiáº¿t kiá»‡m dung lÆ°á»£ng máº¡ng mÃ  cÃ³ giáº£m thiá»ƒu sá»‘ lÆ°á»£ng bá»™ nhá»› (memory) mÃ  thiáº¿t bá»‹ pháº£i dÃ¹ng. Trong component image cá»§a Tini App Ä‘Ã£ há»— trá»£ thuá»™c tÃ­nh lazy-load, báº¡n cÃ³ thá»ƒ xem thÃªm [táº¡i Ä‘Ã¢y](/docs/component/basic/media/image#thu%E1%BB%99c-t%C3%ADnh). Tuy nhiÃªn trong quÃ¡ trÃ¬nh lazyload, khu vá»±c hiá»ƒn thá»‹ hÃ¬nh áº£nh cá»§a báº¡n cÃ³ thá»ƒ sáº½ bá»‹ trá»‘ng máº¥t má»™t chá»—, Ä‘iá»u nÃ y sáº½ khÃ´ng thá»±c sá»± tá»‘t vá» máº·t giao diá»‡n. Báº¡n cÃ³ thá»ƒ giáº£i quyáº¿t báº±ng cÃ¡ch lÃ m má»™t skeleton hÃ¬nh áº£nh vá»›i lazyload

```html
<image
  src="https://LINK_IMAGE"
  lazy-load="{{true}}"
  default-source="https://salt.tikicdn.com/ts/tiniapp/53/55/7f/61855c8b38d161f172616efc27783cdc.png"
/>
```

CÃ¡ch lÃ m á»Ÿ Ä‘Ã¢y lÃ  mÃ¬nh sáº½ dÃ¹ng má»™t hÃ¬nh cÃ³ dung lÆ°á»£ng cá»±c nhá» Ä‘á»ƒ lÃ m hÃ¬nh máº·c Ä‘á»‹nh trong `default-source`, báº¡n cÃ³ thá»ƒ xem hÃ¬nh Ä‘Ã³ á»Ÿ Ä‘Ã¢y https://salt.tikicdn.com/ts/tiniapp/53/55/7f/61855c8b38d161f172616efc27783cdc.png. Vá»›i kÃ­ch thÆ°á»›c chá»‰ ~200B, nÃ³ háº§u nhÆ° sáº½ Ä‘Æ°á»£c load ngay láº­p tá»©c, vÃ  ngay khi hÃ¬nh trong `src` Ä‘Æ°á»£c táº£i xong, nÃ³ sáº½ thay tháº¿ hÃ¬nh trong default-source, nhÆ° váº­y cÃ³ thá»ƒ Ä‘áº£m báº£o cáº£ viá»‡c lazyload hÃ¬nh vÃ  trÃ¡nh tÃ¬nh tráº¡ng bá»‹ trá»‘ng á»Ÿ vÃ¹ng hÃ¬nh áº£nh chÆ°a Ä‘Æ°á»£c táº£i xong

Má»™t cÃ¡ch khÃ¡c Ä‘á»ƒ báº¡n cÃ³ thá»ƒ lÃ m vá»›i lazyload lÃ  kiá»ƒm tra tÃ¬nh tráº¡ng máº¡ng cá»§a ngÆ°á»i dÃ¹ng, náº¿u máº¡ng cháº­m báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c hÃ¬nh áº£nh dung lÆ°á»£ng nhá» Ä‘á»ƒ thay tháº¿, báº¡n cÃ³ thá»ƒ xem jsAPI getNetworkType [táº¡i Ä‘Ã¢y](/docs/api/device/network/get-network-type)

#### Giáº£m thiá»ƒu sá»‘ lÆ°á»£ng hÃ¬nh áº£nh Ä‘Æ°á»£c táº£i cÃ¹ng lÃºc

QuÃ¡ nhiá»u hÃ¬nh áº£nh Ä‘Æ°á»£c táº£i cÃ¹ng lÃºc sáº½ áº£nh hÆ°á»Ÿng Ä‘áº¿n tá»‘c Ä‘á»™ táº£i app cá»§a báº¡n. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡ch thá»©c lazyload mÃ¬nh nÃ³i á»Ÿ trÃªn Ä‘á»ƒ giáº£m thiá»ƒu hÃ¬nh áº£nh Ä‘Æ°á»£c táº£i cÃ¹ng lÃºc. Tuy nhiÃªn vÃ¬ má»™t lÃ½ do nÃ o Ä‘Ã³ mÃ  báº¡n khÃ´ng muá»‘n lazyload, thÃ¬ báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c phÆ°Æ¡ng phÃ¡p nhÆ° infinite scroll Ä‘á»ƒ khi trang cá»§a báº¡n Ä‘Æ°á»£c cuá»™n xuá»‘ng dÆ°á»›i thÃ¬ má»›i táº£i thÃªm. Sáº½ ráº¥t tá»‘t náº¿u báº¡n cÃ³ thá»ƒ káº¿t há»£p cáº£ infinite scroll vÃ  lazyload

### setData

setData lÃ  phÆ°Æ¡ng thá»©c dÃ¹ng Ä‘á»ƒ thay Ä‘á»•i dá»¯ liá»‡u (data) tá»« táº§ng logic (page/component) sang tá»›i táº§ng view (txml) Ä‘á»ƒ giao diá»‡n cÃ³ thá»ƒ cáº­p nháº­t láº¡i. Viá»‡t setData khÃ´ng há»£p lÃ½ cÃ³ thá»ƒ gÃ¢y ra nhá»¯ng lá»—i khÃ´ng muá»‘n vá» performance cá»§a app. CÃ¡c lá»—i dá»… gáº·p nháº¥t Ä‘á»‘i vá»›i setData lÃ  gá»­i quÃ¡ nhiá»u dá»¯ liá»‡u xuá»‘ng hoáº·c gá»i nhiá»u setData cÃ¹ng lÃºc.

#### Giáº£m thiá»ƒu dá»¯ liá»‡u truyá»n vÃ o setData

Khi hÃ m setData Ä‘Æ°á»£c gá»i, sáº½ diá»…n ra quÃ¡ trÃ¬nh serialize dá»¯ liá»‡u vÃ  má»™t sá»‘ xá»­ lÃ½ bÃªn dÆ°á»›i, do Ä‘Ã³ náº¿u dá»¯ liá»‡u quÃ¡ lá»›n Ä‘Æ°á»£c truyá»n vÃ o setData, cÃ³ thá»ƒ sáº½ gÃ¢y ngháº½n quÃ¡ trÃ¬nh truyá»n dá»¯ liá»‡u, lÃ m áº£nh hÆ°á»Ÿng Ä‘áº¿n quÃ¡ trÃ¬nh render view.

Báº¡n nÃªn háº¡n cháº¿ truyá»n dá»¯ liá»‡u quÃ¡ lá»›n vÃ o setData, Ä‘áº·c biá»‡t lÃ  vá»›i cÃ¡c dá»¯ liá»‡u dáº¡ng danh sÃ¡ch (list), khi Ä‘Ã³ báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c thá»§ thuáº­t nhÆ° lazyload, infinite scroll Ä‘á»ƒ láº¥y cÃ¡c data cáº§n thiáº¿t thay vÃ¬ má»™t lÆ°á»£ng lá»›n dá»¯ liá»‡u ngay tá»« Ä‘áº§u.

NgoÃ i ra, báº¡n cÃ³ thá»ƒ hÃ m `$spliceData` Ä‘á»ƒ cÃ³ thá»ƒ giáº£m sá»‘ dá»¯ liá»‡u Ä‘Æ°á»£c truyá»n xuá»‘ng. Thay vÃ¬ truyá»n toÃ n bá»™ data, báº¡n chá»‰ cáº§n truyá»n nhá»¯ng dá»¯ liá»‡u bá»‹ thay Ä‘á»•i.

`$spliceData` nháº­n vÃ o giÃ¡ trá»‹ lÃ  `key: value`, trong Ä‘Ã³ `key` lÃ  má»™t giÃ¡ trá»‹ linh Ä‘á»™ng, báº¡n cÃ³ thá»ƒ truyá»n vÃ o vá»‹ trÃ­ cá»§a máº£ng, hoáº·c thuá»™c tÃ­nh (property) cá»§a má»™t Ä‘á»‘i tÆ°á»£ng (object). Báº¡n cÃ³ thá»ƒ xem á»Ÿ Ä‘oáº¡n code bÃªn dÆ°á»›i

```js
Page({
  data: {
    array: [1, 2, 3]
  },
  async loadMore() {
    return new Promise((resolve) => {
      setTimeout(() => {
        resolve([4, 5, 6]);
      }, 1000);
    });
  },
  async onLoad() {
    const newArray = await this.loadMore();

    // KhÃ´ng nÃªn
    this.setData({ array: this.data.array.concat(newArray) });

    // Sá»­ dá»¥ng vá»›i $spliceData
    this.$spliceData({
      [`array.${this.data.array.length - 1}`]: newArray
    });
  }
});
```

á» vÃ­ dá»¥ trÃªn, ban Ä‘áº§u mÃ¬nh khá»Ÿi táº¡o giÃ¡ trá»‹ `data.array` lÃ  má»™t máº£ng Ä‘Æ¡n giáº£n vá»›i 3 pháº§n tá»­, sau Ä‘Ã³ trong onLoad mÃ¬nh sáº½ gá»i thÃªm má»™t async function loadMore Ä‘á»ƒ láº¥y thÃªm 3 pháº§n tá»­ ná»¯a. Báº¡n cÃ³ thá»ƒ lÃ m cÃ¡ch Ä‘Æ¡n giáº£n lÃ  bá» thÃªm data vÃ o array ban Ä‘áº§u sau Ä‘Ã³ set toÃ n bá»™ data Ä‘Ã³ xuá»‘ng, tuy nhiÃªn náº¿u Ä‘Ã¢y lÃ  má»™t máº£ng phá»©c táº¡p vá»›i ráº¥t nhiá»u pháº§n tá»­ vÃ  nhiá»u thuá»™c tÃ­nh trong Ä‘Ã³, kÃ­ch thÆ°á»›c dá»¯ liá»‡u truyá»n xuá»‘ng sáº½ tÄƒng dáº§n náº¿u báº¡n gá»i loadMore nhiá»u láº§n. Vá»›i cÃ¡ch lÃ m bÃªn dÆ°á»›i, báº¡n sá»­ dá»¥ng `$spliceData`, rá»“i truyá»n tÃªn dá»¯ liá»‡u trong data, á»Ÿ Ä‘Ã¢y lÃ  `array`, kÃ¨m theo vá»‹ trÃ­ mÃ  báº¡n muá»‘n thay Ä‘á»•i, trong trÆ°á»ng há»£p nÃ y lÃ  mÃ¬nh muá»‘n thay Ä‘á»•i biáº¿n array á»Ÿ vá»‹ trÃ­ thá»© 2 (báº¯t Ä‘áº§u tá»« 0), nhÆ° váº­y giÃ¡ trá»‹ má»›i sáº½ Ä‘Æ°á»£c thay Ä‘á»•i thÃ nh `array.2 = [4, 5, 6]`. Sau khi gá»i xong, giÃ¡ trá»‹ cá»§a `array` sáº½ thÃ nh `[1, 2, 3, 4, 5, 6]`

Náº¿u chá»‰ cÃ³ nhu cáº§u thay Ä‘á»•i má»™t thuá»™c trong Ä‘á»‘i tÆ°á»£ng, hoáº·c má»™t pháº§n tá»­ nÃ o Ä‘Ã³ trong máº£ng, báº¡n cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng setData theo cÃ¡ch sau:

```js
Page({
  data: {
    app: {
      name: 'Tini App',
      company: 'Tiki'
    },
    array: [
      {
        value: 0
      },
      {
        value: 1
      }
    ]
  },
  onLoad() {
    // 1. Äá»•i giÃ¡ trá»‹ thuá»™c tÃ­nh cá»§a Ä‘á»‘i tÆ°á»£ng
    // KhÃ´ng nÃªn
    this.setData({
      app: { ...this.data.app, country: 'Vietnam' }
    });
    // Chá»‰ thay Ä‘á»•i thuá»™c tÃ­nh cáº§n thiáº¿t
    this.setData({ 'app.country': 'Vietnam' });

    // 2. Äá»•i giÃ¡ trá»‹ pháº§n tá»­ trong máº£ng
    // KhÃ´ng nÃªn
    this.setData({
      array: this.data.array.map((item, index) =>
        index === 1 ? { value: 2 } : item
      )
    });
    // Chá»‰ Ä‘á»•i Ä‘Ãºng vá»‹ trÃ­ cá»§a pháº§n tá»­ trong máº£ng
    this.setData({ 'array[1]': { value: 2 } });
  }
});
```

#### Giáº£m thiá»ƒu sá»‘ láº§n gá»i setData

Náº¿u báº¡n gá»i setData quÃ¡ nhiá»u láº§n cÃ¹ng lÃºc, sáº½ dáº«n Ä‘áº¿n bá»‹ ngháº½n khi truyá»n dá»¯ liá»‡u, Ä‘á»“ng thá»i cÃ³ thá»ƒ gÃ¢y ra tÃ¬nh tráº¡ng UI bá»‹ render nhiá»u láº§n, hoáº·c tá»‡ hÆ¡n ná»¯a lÃ  UI bá»‹ block láº¡i, dáº«n Ä‘áº¿n ngÆ°á»i dÃ¹ng khÃ´ng thá»ƒ tÆ°Æ¡ng tÃ¡c trÃªn app cá»§a báº¡n. TÃ¬nh tráº¡ng nÃ y ráº¥t dá»… xáº£y ra náº¿u báº¡n gá»i setData trong cÃ¡c sá»± kiá»‡n page scroll hoáº·c swipe, khi Ä‘Ã³ sá»± pháº£n há»“i tá»« giao diá»‡n tá»›i ngÆ°á»i cÃ³ thá»ƒ bá»‹ cháº­m trá»…, gÃ¢y ra nhá»¯ng tráº£i nghiá»‡m khÃ´ng tá»‘t.

CÃ¡ch lÃ m Ä‘Æ¡n giáº£n lÃ  báº¡n hÃ£y xá»­ lÃ½ háº¿t cÃ¡c logic trong má»™t hÃ m rá»“i hÃ£y gá»i setData.
DÆ°á»›i Ä‘Ã¢y lÃ  má»™t trÆ°á»ng há»£p báº¡n nÃªn trÃ¡nh khi pháº£i gá»i setData tá»›i 2 láº§n

```js
Page({
  data: {
    counter1: 0,
    counter2: 0
  },
  onLoad() {
    const newCounter1 = this.data.counter1 + 1;
    this.setData({ counter1: newCounter1 });

    const newCounter2 = this.data.counter2 + 1;
    this.setData({ counter2: newCounter2 });
  }
});
```

Thay vÃ o Ä‘Ã³ hÃ£y gá»i khi xá»­ lÃ½ táº¥t cáº£ logic xong:

```js
Page({
  data: {
    counter1: 0,
    counter2: 0
  },
  onLoad() {
    const newCounter1 = this.data.counter1 + 1;
    const newCounter2 = this.data.counter2 + 1;
    this.setData({
      counter1: newCounter1,
      counter2: newCounter2
    });
  }
});
```

Trong trÆ°á»ng há»£p báº¡n cáº§n gá»i nhiá»u setData cÃ¹ng lÃºc, hÃ£y sá»­ dá»¥ng `$batchedUpdates`

```js
Page({
  data: {
    counter: 0
  },
  plus() {
    setTimeout(() => {
      this.$batchedUpdates(() => {
        this.setData({
          counter: this.data.counter + 1
        });
        this.setData({
          counter: this.data.counter + 1
        });
      });
    }, 200);
  }
});
```

```html
<!-- pages/index/index.txml -->
<view> {{counter}} </view>
<button onTap="plus">+2</button>
```

Trong vÃ­ dá»¥ trÃªn, má»—i láº§n báº¥m vÃ o button, giÃ¡ trá»‹ counter sáº½ tÄƒng lÃªn 2. Bá»Ÿi vÃ¬ `$batchedUpdates` sáº½ káº¿t há»£p cÃ¡c setData thÃ nh má»™t láº§n gá»i duy nháº¥t, trÃ¡nh trÆ°á»ng há»£p setData bá»‹ gá»i nhiá»u láº§n vÃ  UI khÃ´ng pháº£i bá»‹ re-render quÃ¡ nhiá»u

NgoÃ i viá»‡c giáº£m thiá»ƒu sá»‘ lÆ°á»£ng dá»¯ liá»‡u khi gá»i setData hoáº·c trÃ¡nh viá»‡c gá»i setData liÃªn tá»¥c nhiá»u láº§n, náº¿u page cá»§a báº¡n chá»©a nhiá»u component, vÃ  má»—i component thá»±c hiá»‡n má»™t logic riÃªng, khi viá»‡c setData chá»‰ dáº«n Ä‘áº¿n sá»± thay Ä‘á»•i má»™t component mÃ  khÃ´ng pháº£i toÃ n bá»™, hÃ£y cÃ¢n nháº¯c mang setData vÃ  dá»¯ liá»‡u Ä‘Ã³ vÃ o component, nhÆ° váº­y viá»‡c trigger re-render chá»‰ xáº£y ra á»Ÿ trong component cáº§n sá»± thay Ä‘á»•i Ä‘Ã³. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡ch sau náº¿u cáº§n gá»i setData tá»« page tá»›i component

```js title=component/index/index
Component({
  didMount() {
    this.$page.xxcomponent = this;
  }
});
```

```js title=page/index/index
Page({
  onPageScroll(e) {
    if (this.xxcomponent) {
      this.xxcomponent.setData({
        scrollTop: e.scrollTop
      });
    }
  }
});
```

Vá»›i cÃ¡ch lÃ m trÃªn, báº¡n chá»‰ viá»‡c gÃ¡n component cá»§a báº¡n vÃ o `$page` (page hiá»‡n táº¡i) vá»›i giÃ¡ trá»‹ lÃ  `this`, váº­y lÃ  báº¡n cÃ³ thá»ƒ gá»i cÃ¡c phÆ°Æ¡ng thá»©c cá»§a component Ä‘Ã³ tá»« trong page, vÃ­ dá»¥ á»Ÿ trÃªn lÃ  mÃ¬nh gá»i setData vÃ o component khi page scroll. Báº¡n cÃ³ thá»ƒ xem thÃªm vá» component object [á»Ÿ Ä‘Ã¢y](/docs/framework/component/object#component-instance-properties).
